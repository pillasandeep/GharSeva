<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Admin Dashboard</title>
    <link rel="stylesheet" th:href="@{/css/stylenavbar.css}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">

    <style>
        body {
            margin: 10px;
            position: absolute;
            left: 69px;
            font-family: 'Segoe UI', 'Roboto', Arial, sans-serif;
            background-color: #f6f8fa;
            color: #343a40;
            min-height: 100vh;
        }
		.page-title {
			position: absolute;
			left :50%;
			width:600px;
		    font-size: 28px;
		    font-weight: 700;
		    color: #2c3e50;          /* Dark blue-gray */
		    text-align: center;
		    margin: 20px 0;
		    padding: 10px;
		    background: linear-gradient(to right, #f8f9fa, #e9ecef); /* Light gradient */
		    border-radius: 12px;
		    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
		}

		.page-title span {
			
		    color: #e67e22;          /* Highlighted date in orange */
		    font-weight: 600;
		    font-size: 22px;
		    margin-left: 8px;
		}

        .table-container {
            background-color: #fff;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            margin-top: 20px;
            border: none;
            padding: 0;
        }
        .table thead th {
            background-color: #343a40;
            color: #ffffff;
            font-weight: 600;
            padding: 12px 15px;
        }
        .table tbody td {
            padding: 12px 15px;
            vertical-align: middle;
        }
        .table tbody tr:hover {
            background-color: #f8f9fa;
        }
        .section-title {
            margin-top: 50px;
            font-size: 22px;
            font-weight: bold;
            color: #212529;
        }
        .no-data-msg {
            background-color: #fff8e1;
            color: #6c4f00;
            border: 1px solid #ffe082;
            padding: 15px 20px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 500;
            text-align: center;
            box-shadow: 0 2px 6px rgba(0,0,0,0.08);
            max-width: 600px;
            margin: 30px auto;
        }
        .action-btn {
            min-width: 120px;
        }			.page-title {
			    margin: 20px 0;
			    font-size: 26px;
			    font-weight: 700;
			    color: #212529;
			    text-align: center;
			    background: linear-gradient(135deg, #007bff, #00c6ff);
			    -webkit-background-clip: text;
			    -webkit-text-fill-color: transparent;
			}

			.page-title span {
			    font-size: 20px;
			    font-weight: 500;
			    color: #495057;
			}

			/* Responsive */
			@media (max-width: 768px) {
			    .page-title {
			        font-size: 22px;
			    }
			    .page-title span {
			        display: block; /* date goes below on small screens */
			        font-size: 18px;
			        margin-top: 5px;
			    }
			}

		
    </style>
</head>
<body>
<!-- Sidebar -->
<div th:replace="~{fragments/admin_navbar :: sidebar}"></div>
<!-- Top Navigation Buttons -->
<a th:href="@{download}">
   <button>Download PDF</button>
</a>
<h2 class="page-title">
    Daily Bookings - 
    <span th:text="${#temporals.format(T(java.time.LocalDate).now(), 'dd MMMM yyyy')}"></span>
</h2>
<div class="main-content">

    <!-- PENDING BOOKINGS -->
    <h2 class="section-title">Pending Bookings</h2>
    <div th:if="${#lists.isEmpty(todaysBookings)}" class="no-data-msg">
        No pending bookings.
    </div>
    <div class="table-container" th:if="${!#lists.isEmpty(todaysBookings)}">
        <table class="table table-bordered table-striped table-hover align-middle">
            <thead>
                <tr>
					<th>Booking Id</th>
                    <th>Customer Name</th>
                    <th>Service Type</th>
                    <th>Extra Phone Number</th>
                    <th>Time</th>
                    <th>Address / Landmark</th>
                    <th>Price (â‚¹)</th>
                    <th>State</th>
					<th>Technician ID</th>
					<th>Action</th>
                </tr>
            </thead>
			<tbody>
			<tr th:each="booking : ${todaysBookings}">
			    <form th:action="@{/changeState}" method="post">
			        <td th:text="${booking.id}"></td>	
			        <td>
			            <div th:text="${booking.name}"></div>
			            <div class="text-muted small" th:text="${booking.phonenumber}"></div>
			        </td>
			        <td th:text="${booking.servicename}"></td>
			        <td th:text="${booking.phonenumber}"></td>
			        <td th:text="${#temporals.format(booking.time, 'hh:mm a')}"></td>
			        <td>
			            <div th:text="${booking.address}"></div>
			            <div class="text-muted small" th:text="${booking.landmark}"></div>
			        </td>
			        <td class="text-right" th:text="${#numbers.formatInteger(booking.price, 0, 'COMMA')}"></td>
			        <td th:text="${booking.state}"></td>

			        <!-- Technician ID + Submit button in the same row -->
			        <td>
			            <input type="number" name="techid" placeholder="Enter Technician Id" class="form-control form-control-sm" required>
			        </td>
			        <td>
			            <input type="hidden" name="id" th:value="${booking.id}">
			            <button type="submit" class="btn btn-primary btn-sm w-100">
			                Assign to Technician
			            </button>
			        </td>
			    </form>
			</tr>
			</tbody>
        </table>
    </div>

    <!-- ASSIGNED BOOKINGS -->
    <h2 class="section-title">Assigned Bookings</h2>
    <div th:if="${#lists.isEmpty(assignedBookings)}" class="no-data-msg">
        No assigned bookings.
    </div>
    <div class="table-container" th:if="${!#lists.isEmpty(assignedBookings)}">
        <table class="table table-bordered table-striped table-hover align-middle">
            <thead>
                <tr>
					<th>Booking Id</th>
                    <th>Serviec Name</th>
                    <th>Customer Name Type</th>
                    <th>date</th>
                    <th>Technicain Name</th>
					<th>Action</th>
                    
                </tr>
            </thead>
            <tbody>
                <tr th:each="booking : ${assignedBookings}">
					<td th:text="${booking[0]}"></td>	
                    
                    <td th:text="${booking[1]}"></td>
                    <td th:text="${booking[2]}"></td>
					<td th:text="${booking[3]}"></td>
					<td th:text="${booking[4]}"></td>

					
                   <!-- <td th:text="${#temporals.format(booking.time, 'hh:mm a')}"></td>
                    <td>
                        <div th:text="${booking.address}"></div>
                        <div class="text-muted small" th:text="${booking.landmark}"></div>
                    </td>
                    <td class="text-right" th:text="${#numbers.formatInteger(booking.price, 0, 'COMMA')}"></td>-->
                    <td>
                        <form th:action="@{changeState}" method="post">
                            <input type="hidden" name="id" th:value="${booking[0]}">
                            <input type="hidden" name="status" value="completed">
                            <button type="submit" class="btn btn-success action-btn">Mark as Completed</button>
                        </form>
						
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- COMPLETED BOOKINGS -->
    <h2 class="section-title">Completed Bookings</h2>
    <div th:if="${#lists.isEmpty(completedBookings)}" class="no-data-msg">
        No completed bookings.
    </div>
    <div class="table-container" th:if="${!#lists.isEmpty(completedBookings)}">
        <table class="table table-bordered table-striped table-hover align-middle">
            <thead>
                <tr>
					<th>Booking Id</th>
                    <th>Service Name</th>
                    <th>Service Type</th>
                    <th>Phone</th>
                    <th>Technicain Name</th>
               
                </tr>
            </thead>
            <tbody>
				
				
				<tr th:each="booking : ${completedBookings}">
								<td th:text="${booking[0]}"></td>	
				                   
				                   <td th:text="${booking[1]}"></td>
				                   <td th:text="${booking[2]}"></td>
								<td th:text="${booking[3]}"></td>
								<td th:text="${booking[4]}"></td>
				</tr>
              <!-- <tr th:each="booking : ${completedBookings}">
					<td th:text="${booking.id}"></td>	
                    <td>
                        <div th:text="${booking.name}"></div>
                        <div class="text-muted small" th:text="${booking.phonenumber}"></div>
                    </td>
                    <td th:text="${booking.servicename}"></td>
                    <td th:text="${booking.phonenumber}"></td>
                    <td th:text="${#temporals.format(booking.time, 'hh:mm a')}"></td>
                    <td>
                        <div th:text="${booking.address}"></div>
                        <div class="text-muted small" th:text="${booking.landmark}"></div>
                    </td>
                    <td class="text-right" th:text="${#numbers.formatInteger(booking.price, 0, 'COMMA')}"></td>
                </tr> -->
            </tbody>
        </table>
    </div>

</div>

</body>
</html>
